/*
 * jQuery Data Link Plugin
 * http://github.com/jquery/jquery-datalink
 *
 * Copyright Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
jQuery.plugin("jQuery.fn.datalink",function(c,a){var h=c.cleanData,i=[],d={val:"val",html:"html",text:"text"};function b(m,l,k){if(m.nodeType){var n=d[l]||"attr";c(m)[n](k)}else{c(m).data(l,k)}}function e(n){var m=c.data(n),k,l=m._getLinks||(k={s:[],t:[]},m._getLinks=function(){return k});return l()}function f(m,k,l){k.on(m.nodeType?"change":"changeData",l)}function j(m,k,l){k.off(m.nodeType?"change":"changeData",l)}c.extend({cleanData:function(m){for(var n,o=0,p;(p=m[o])!=null;o++){var l=c.data(p,"_getLinks");if(l){l=l();var k=c(p);c.each(l.s,function(){j(p,k,this.handler);if(this.handlerRev){j(this.target,c(this.target),this.handlerRev)}});c.each(l.t,function(){j(this.source,c(this.source),this.handler);if(this.handlerRev){j(p,k,this.handlerRev)}});l.s=[];l.t=[]}}h(m)},convertFn:{"!":function(k){return !k}}});function g(u,q,p,n,k,s){var s=u.target,r=u.type==="changeData",v,t,l;if(r){l=q;if(u.namespace){l+="."+u.namespace}}else{l=(s.name||s.id)}if(!n){v=l}else{var o=n[l];if(!o){return null}v=o.name;t=o.convert;if(typeof t==="string"){t=c.convertFn[t]}}return{name:v,convert:t,value:r?p:c(s).val()}}c.extend(c.fn,{link:function(q,k){var s=this;if(!q){return s}function o(u){var t="[name="+u+"], [id="+u+"]";return s.filter(t).add(s.find(t))}if(typeof q==="string"){q=c(q,this.context||null)[0]}var m=!k,l,p,r=function(w,z,u){var t=g(w,z,u,l);if(t){var v=t.name,x=t.value,y=t.convert;if(y){x=y(x,w.target,q)}if(x!==a){b(q,v,x)}}},n=function(w,z,u){var t=g(w,z,u,p);if(t){var v=t.name,x=t.value,y=t.convert;o(v).each(function(){u=x;if(y){u=y(u,q,this)}if(u!==a){b(this,"val",u)}})}};if(k){c.each(k,function(z,u){var x=u,y,w,t;if(c.isPlainObject(u)){x=u.name||z;y=u.convert;w=u.convertBack;t=u.twoWay!==false;m|=t}else{m=t=true}if(t){p=p||{};p[z]={name:x,convert:w}}l=l||{};l[x]={name:z,convert:y,twoWay:t}})}s.each(function(){f(this,c(this),r);var t={handler:r,handlerRev:m?n:null,target:q,source:this};e(this).s.push(t);if(q.nodeType){e(q).t.push(t)}});if(m){f(q,c(q),n)}return s},unlink:function(k){this.each(function(){var n=c(this),m=e(this).s;for(var p=m.length-1;p>=0;p--){var q=m[p];if(q.target===k){j(this,n,q.handler);if(q.handlerRev){j(q.target,c(q.target),q.handlerRev)}m.splice(p,1);var l=e(q.target).t,o=c.inArray(q,l);if(o!==-1){l.splice(o,1)}}}})}})});