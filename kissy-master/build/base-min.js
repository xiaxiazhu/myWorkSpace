/*
Copyright 2013, KISSY v1.40
MIT Licensed
build time: Oct 29 14:13
*/
KISSY.add("base/attribute",function(g,j){function p(a,b){return"string"==typeof b?a[b]:b}function n(a,b,d,e,c,f,i,h){i=i||d;return a.fire(b+g.ucfirst(d)+"Change",g.mix({attrName:i,subAttrName:f,prevVal:e,newVal:c},h))}function l(a,b,d){var e=a[b];!d&&!e&&(a[b]=e={});return e||{}}function u(a,b){for(var d=0,e=b.length;a!=j&&d<e;d++)a=a[b[d]];return a}function v(a){var b;-1!==a.indexOf(".")&&(b=a.split("."),a=b.shift());return{path:b,name:a}}function w(a,b,d){var e=d;if(b){var a=e=a===j?{}:g.clone(a),
c=b.length-1;if(0<=c){for(var f=0;f<c;f++)a=a[b[f]];a!=j&&(a[b[f]]=d)}}return e}function s(a,b,d,e,c){var f,i,h;f=v(b);var x=b,b=f.name;f=f.path;h=a.get(b);var m=b,y=l(a,"__defaultBeforeFns");y[m]||(y[m]=1,m="before"+g.ucfirst(m)+"Change",a.publish(m,{defaultFn:t}));f&&(i=u(h,f));if(!e.force&&(!f&&h===d||f&&i===d))return j;d=w(h,f,d);d=g.mix({attrName:b,subAttrName:x,prevVal:h,newVal:d,_opts:e,_attrs:c,target:a},e.data);if(e.silent){if(k===t.call(a,d))return k}else if(k===a.fire("before"+g.ucfirst(b)+
"Change",d))return k;return a}function t(a){if(a.target!==this)return j;var b=a.newVal,d=a.prevVal,e=a.attrName,c=a.subAttrName,f=a._attrs,a=a._opts,b=this.setInternal(e,b);if(b===k)return b;a.silent||(b=this.__attrVals[e],n(this,"after",e,d,b,c,null,a.data),f?f.push({prevVal:d,newVal:b,attrName:e,subAttrName:c}):n(this,"","*",[d],[b],[c],[e],a.data));return j}function o(a,b){var d=a.__attrs,e=l(d,b,1),c=e.valueFn;if(c&&(c=p(a,c)))c=c.call(a),c!==j&&(e.value=c),delete e.valueFn,d[b]=e;return e.value}
function q(a,b,d,e){var c,f;c=v(b);b=c.name;if(c=c.path)f=a.get(b),d=w(f,c,d);if((c=l(a.__attrs,b).validator)&&(c=p(a,c)))if(a=c.call(a,d,b,e),a!==j&&!0!==a)return a;return j}var r={},k=!1;return{INVALID:r,getAttrs:function(){return this.__attrs},getAttrVals:function(){var a={},b,d=this.__attrs;for(b in d)a[b]=this.get(b);return a},addAttr:function(a,b,d){var e=this.__attrs,c,b=g.clone(b);(c=e[a])?g.mix(c,b,d):e[a]=b;return this},addAttrs:function(a,b){var d=this;g.each(a,function(b,a){d.addAttr(a,
b)});b&&d.set(b);return d},hasAttr:function(a){return this.__attrs.hasOwnProperty(a)},removeAttr:function(a){var b=this.__attrVals,d=this.__attrs;this.hasAttr(a)&&(delete d[a],delete b[a]);return this},set:function(a,b,d){if(g.isPlainObject(a)){var d=b||{},b=Object(a),e=[],c,f=[];for(a in b)(c=q(this,a,b[a],b))!==j&&f.push(c);if(f.length)return d.error&&d.error(f),k;for(a in b)s(this,a,b[a],d,e);var i=[],h=[],x=[],m=[];g.each(e,function(b){h.push(b.prevVal);x.push(b.newVal);i.push(b.attrName);m.push(b.subAttrName)});
i.length&&n(this,"","*",h,x,m,i,d.data);return this}d=d||{};c=q(this,a,b);return c!==j?(d.error&&d.error(c),k):s(this,a,b,d)},setInternal:function(a,b){var d=j,e=l(this.__attrs,a).setter;if(e&&(e=p(this,e)))d=e.call(this,b,a);if(d===r)return k;d!==j&&(b=d);this.__attrVals[a]=b;return j},get:function(a){var b,d=this.__attrVals,e,c;-1!==a.indexOf(".")&&(b=a.split("."),a=b.shift());e=l(this.__attrs,a,1).getter;c=a in d?d[a]:o(this,a);if(e&&(e=p(this,e)))c=e.call(this,c,a);!(a in d)&&c!==j&&(d[a]=c);
b&&(c=u(c,b));return c},reset:function(a,b){if("string"==typeof a)return this.hasAttr(a)?this.set(a,o(this,a),b):this;var b=a,d=this.__attrs,e={};for(a in d)e[a]=o(this,a);this.set(e,b);return this}}});
KISSY.add("base",function(g,j,p){function n(b,d){return function(a){return function(){d?a.apply(this,arguments):this.callSuper.apply(this,arguments);var c=arguments.callee.__owner__.__extensions__||[];d&&c.reverse();var f=arguments,i;if(i=c&&c.length)for(var h=0;h<i;h++){var g=c[h]&&(!b?c[h]:c[h].prototype[b]);g&&g.apply(this,f||[])}d?this.callSuper.apply(this,arguments):a.apply(this,arguments)}}}function l(b){var d=this.constructor;l.superclass.constructor.apply(this,arguments);this.__attrs={};this.__attrVals=
{};for(this.userConfig=b;d;){var a=d[q];if(a){var c=void 0;for(c in a)this.addAttr(c,a[c],!1)}d=d.superclass?d.superclass.constructor:null}if(d=b)for(var f in d)this.setInternal(f,d[f]);f=this.get("listeners");for(var i in f)this.on(i,f[i]);this.initializer();w(this);o.call(this,"pluginInitializer");this.bindInternal();this.syncInternal()}function u(b){t(b,this,this.__hooks__||{});g.mix(this.prototype,b)}function v(b){var a;b.target==this&&(a=this[k+b.type.slice(5).slice(0,-6)],a.call(this,b.newVal,
b))}function w(b){var a=b.get("plugins");g.each(a,function(b,c){"function"===typeof b&&(a[c]=new b)})}function s(b){return function(){return b.apply(this,arguments)}}function t(b,d,e){if(d.__extensions__.length)for(c in e)b[c]=b[c]||a;for(var c in e)c in b&&(b[c]=e[c](b[c]));g.each(b,function(a,c){if("function"==typeof a){var e=0;if(a.__owner__){var g=a.__owner__;delete a.__owner__;delete a.__name__;var e=a.__wrapped__=1,j=s(a);j.__owner__=g;j.__name__=c;g.prototype[c]=j}else a.__wrapped__&&(e=1);
e&&(b[c]=a=s(a));a.__owner__=d;a.__name__=c}})}function o(b){var a,e=this.get("plugins");if(a=e.length)for(var c=0;c<a;c++)e[c][b]&&e[c][b](this)}var q="ATTRS",r=g.ucfirst,k="_onSet",a=g.noop;g.augment(l,j);g.extend(l,p.Target,{initializer:a,__getHook:n,__callPluginsMethod:o,callSuper:function(){var b,a,e=arguments;"function"==typeof this&&this.__name__?(b=this,a=e[0],e=Array.prototype.slice.call(e,1)):(b=arguments.callee.caller,b.__wrapped__&&(b=b.caller),a=this);var c=b.__name__;if(c)return b=b.__owner__.superclass[c],
!b?void 0:b.apply(a,e||[])},bindInternal:function(){var b=this.getAttrs(),a,e;for(a in b)if(e=k+r(a),this[e])this.on("after"+r(a)+"Change",v)},syncInternal:function(){var b=[],a;a=this.constructor;for(var e=this.getAttrs();a;)b.push(a),a=a.superclass&&a.superclass.constructor;b.reverse();for(a=0;a<b.length;a++){var c=b[a].ATTRS||{},f;for(f in c)if(f in e){var g,h;(h=this[k+r(f)])&&0!==e[f].sync&&void 0!==(g=this.get(f))&&h.call(this,g)}}},plug:function(a){"function"===typeof a&&(a=new a);a.pluginInitializer&&
a.pluginInitializer(this);this.get("plugins").push(a);return this},unplug:function(a){var d=[],e=this,c="string"==typeof a;g.each(e.get("plugins"),function(f){var g=0,h;a&&(c?(h=f.get&&f.get("pluginId")||f.pluginId,h!=a&&(d.push(f),g=1)):f!=a&&(d.push(f),g=1));g||f.pluginDestructor(e)});e.setInternal("plugins",d);return e},getPlugin:function(a){var d=null;g.each(this.get("plugins"),function(e){if((e.get&&e.get("pluginId")||e.pluginId)==a)return d=e,!1});return d},destructor:g.noop,destroy:function(){this.get("destroyed")||
(o.call(this,"pluginDestructor"),this.destructor(),this.set("destroyed",!0),this.fire("destroy"),this.detach())}});g.mix(l,{__hooks__:{initializer:n(),destructor:n("__destructor",!0)},ATTRS:{plugins:{value:[]},destroyed:{value:!1},listeners:{value:[]}},extend:function d(a,c,f){var i;g.isArray(a)||(f=c,c=a,a=[]);f=f||{};c=g.merge(c);i=c.hasOwnProperty("constructor")?c.constructor:function(){this.callSuper.apply(this,arguments)};c.constructor=i;var h=this.__hooks__;h&&(f.__hooks__=g.merge(h,f.__hooks__));
i.__extensions__=a;t(c,i,f.__hooks__||{});h=this.prototype;h=h.__inheritedStatics__=h.__inheritedStatics__||f.inheritedStatics;f.inheritedStatics&&h!==f.inheritedStatics&&g.mix(h,f.inheritedStatics);h&&g.mix(i,h);delete f.inheritedStatics;g.extend(i,this,c,f);if(a.length){var j={},k={};g.each(a.concat(i),function(a){if(a){g.each(a[q],function(a,c){var d=j[c]=j[c]||{};g.mix(d,a)});var a=a.prototype,c;for(c in a)a.hasOwnProperty(c)&&(k[c]=a[c])}});i[q]=j;k.constructor=i;g.augment(i,k)}i.extend=i.extend||
d;i.addMembers=u;return i}});return g.Base=l},{requires:["base/attribute","event/custom"]});
