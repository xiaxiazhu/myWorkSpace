/*
Copyright 2013, KISSY v1.40dev
MIT Licensed
build time: Oct 22 17:03
*/
KISSY.add("anim/base/queue",function(b,e){function h(a,d,c){var d=d||g,b,j=e.data(a,i);!j&&!c&&e.data(a,i,j={});j&&(b=j[d],!b&&!c&&(b=j[d]=[]));return b}var i=b.guid("ks-queue-"+b.now()+"-"),g=b.guid("ks-queue-"+b.now()+"-"),f;return f={queueCollectionKey:i,queue:function(a,b,c){a=h(a,b);a.push(c);return a},remove:function(a,d,c){var e=h(a,d,1);e&&(c=b.indexOf(c,e),-1<c&&e.splice(c,1));e&&!e.length&&f.clearQueue(a,d);return e},clearQueues:function(a){e.removeData(a,i)},clearQueue:function(a,d){var d=
d||g,c=e.data(a,i);c&&delete c[d];b.isEmptyObject(c)&&e.removeData(a,i)},dequeue:function(a,b){var c=h(a,b,1);c&&(c.shift(),c.length||f.clearQueue(a,b));return c}}},{requires:["dom"]});
KISSY.add("anim/base/utils",function(b,e,h,i){var g=b.guid("ks-anim-unqueued-"+b.now()+"-"),f=b.guid("ks-anim-paused-"+b.now()+"-");return{saveRunningAnim:function(a){var d=a.node,c=e.data(d,g);c||e.data(d,g,c={});c[b.stamp(a)]=a},removeRunningAnim:function(a){var d=a.node,c=e.data(d,g);c&&(delete c[b.stamp(a)],b.isEmptyObject(c)&&e.removeData(d,g))},isAnimPaused:function(a){var d=e.data(a.node,f);return d?!!d[b.stamp(a)]:0},removePausedAnim:function(a){var d=a.node,c=e.data(d,f);c&&(delete c[b.stamp(a)],
b.isEmptyObject(c)&&e.removeData(d,f))},savePausedAnim:function(a){var d=a.node,c=e.data(d,f);c||e.data(d,f,c={});c[b.stamp(a)]=a},isAnimRunning:function(a){var d=e.data(a.node,g);return d?!!d[b.stamp(a)]:0},isElPaused:function(a){return(a=e.data(a,f))&&!b.isEmptyObject(a)},isElRunning:function(a){return(a=e.data(a,g))&&!b.isEmptyObject(a)},pauseOrResumeQueue:function(a,d,c){a=e.data(a,"resume"==c?f:g);a=b.merge(a);b.each(a,function(a){if(d===i||a.config.queue==d)a[c]()})},stopEl:function(a,d,c,f){c&&
(f===i?h.clearQueues(a):!1!==f&&h.clearQueue(a,f));a=e.data(a,g);a=b.merge(a);b.each(a,function(a){(f===i||a.config.queue==f)&&a.stop(d)})}}},{requires:["dom","./queue"]});
KISSY.add("anim/base",function(b,e,h,i,g){function f(j){var c;f.superclass.constructor.call(this);i.Defer(this);this.config=j;var d=j.node;b.isPlainObject(d)||(d=e.get(j.node));this.node=this.el=d;this._backupProps={};this._propsData={};this.then(a);(c=j.complete)&&this.then(c)}function a(a){var c,a=a[0];b.isEmptyObject(c=a._backupProps)||e.css(a.node,c)}var d=e.NodeType,c=b.noop,p={toggle:1,hide:1,show:1};b.extend(f,i,{on:function(a,b){"please use promise api of anim instead";"complete"==a?this.then(b):
"end"==a?this.fin(b):"step"==a?this.progress(b):"not supported event for anim: "+a;return this},prepareFx:c,runInternal:function(){var a=this,c=a.config,f=a.node,g,i=a._backupProps,m=a._propsData,k=c.to,q=c.delay||0,n=c.duration;h.saveRunningAnim(a);b.each(k,function(a,d){b.isPlainObject(a)||(a={value:a});m[d]=b.mix({delay:q,easing:c.easing,frame:c.frame,duration:n},a)});if(f.nodeType==d.ELEMENT_NODE){if(k.width||k.height)k=f.style,b.mix(i,{overflow:k.overflow,"overflow-x":k.overflowX,"overflow-y":k.overflowY}),
k.overflow="hidden","inline"===e.css(f,"display")&&"none"===e.css(f,"float")&&(b.UA.ie?k.zoom=1:k.display="inline-block");var o,l;l="none"===e.css(f,"display");b.each(m,function(c,b){g=c.value;if(p[g]){if("hide"==g&&l||"show"==g&&!l)return a.stop(!0),o=!1;i[b]=e.style(f,b);"toggle"==g?g=l?"show":"hide":"hide"==g?(c.value=0,i.display="none"):(c.value=e.css(f,b),e.css(f,b,0),e.show(f))}});if(!1===o)return}a.startTime=b.now();b.isEmptyObject(m)?(a.__totalTime=1E3*n,a.__waitTimeout=setTimeout(function(){a.stop(!0)},
a.__totalTime)):(a.prepareFx(),a.doStart())},isRunning:function(){return h.isAnimRunning(this)},isPaused:function(){return h.isAnimPaused(this)},pause:function(){this.isRunning()&&(this._runTime=b.now()-this.startTime,this.__totalTime-=this._runTime,h.removeRunningAnim(this),h.savePausedAnim(this),this.__waitTimeout?clearTimeout(this.__waitTimeout):this.doStop());return this},doStop:c,doStart:c,resume:function(){var a=this;a.isPaused()&&(a.startTime=b.now()-a._runTime,h.removePausedAnim(a),h.saveRunningAnim(a),
a.__waitTimeout?a.__waitTimeout=setTimeout(function(){a.stop(!0)},a.__totalTime):(a.beforeResume(),a.doStart()));return a},beforeResume:c,run:function(){var a;a=this.config.queue;!1===a?this.runInternal():(a=g.queue(this.node,a,this),1==a.length&&this.runInternal());return this},stop:function(a){var c=this.node,b=this.config.queue;if(this.isResolved()||this.isRejected())return this;this.__waitTimeout&&(clearTimeout(this.__waitTimeout),this.__waitTimeout=0);if(!this.isRunning()&&!this.isPaused())return!1!==
b&&g.remove(c,b,this),this;this.doStop(a);h.removeRunningAnim(this);h.removePausedAnim(this);var d=this.defer;a?d.resolve([this]):d.reject([this]);!1!==b&&(a=g.dequeue(c,b))&&a[0]&&a[0].runInternal();return this}});f.Utils=h;f.Q=g;return f},{requires:["dom","./base/utils","promise","./base/queue"]});
